/**
 * social-share-links-counters
 * @version 0.1.0
 */
!function(t){function e(e,r){this.element=e,this.$element=t(e),this.options=t.extend({},s,r),this._defaults=s,this._name=n,this.init()}var n="socialShareCounters",s={innerSpan:!0,spanClass:n+"__counter"},r={},a=[{name:"twitter",host:/(www\.)?(twitter\.com)$/,shareParam:"url",counterUrl:"https://cdn.api.twitter.com/1/urls/count.json?url=",responseKey:"count"},{name:"facebook",host:/(www\.)?(facebook\.com)$/,shareParam:"u",counterUrl:"http://graph.facebook.com/?id=",responseKey:"shares"}];e.prototype={init:function(){"A"===this.element.tagName&&""!==this.element.search&&(this.options.innerSpan&&this.$element.data("span-class",this.options.spanClass),this.parseLink(this.element))},parseLink:function(t){for(var e=t.host,n=t.search.substring(1).split("&"),s=0;s<a.length;s++)if(a[s].host.test(e)&&!r[t.href]){for(var o={counter:0,provider:a[s]},i=0;i<n.length;i++){var h=n[i].split("=");if(a[s].shareParam===h[0]){o.url=h[1];break}}r[t.href]=o,this.getCounter(t,o)}},getCounter:function(e,n){var s=n.provider.counterUrl+n.url+"&callback=?",r=this.updateCounters,a=this.options;t.getJSON(s).done(function(t){n.counter=t[n.provider.responseKey],r(e,a)})},updateCounters:function(e){t('a[href="'+e.href+'"]').each(function(){var n=t(this),s=r[e.href],a=n.data("span-class");n.data("counter",s.counter),a&&(0===n.find(a).length?n.append(t("<span>").addClass(a).text(s.counter)):n.find(a).text(s.counter))})}},t.fn[n]=function(s){return this.each(function(){t.data(this,"plugin_"+n)||t.data(this,"plugin_"+n,new e(this,s))})}}(jQuery,window,document);